var CSRFToken,anchoredLink,browserCompatibleDocumentParser,browserIsntBuggy,browserSupportsPushState,browserSupportsTurbolinks,cacheCurrentPage,cacheSize,changePage,constrainPageCacheTo,createDocument,crossOriginLink,currentState,executeScriptTags,extractLink,extractTitleAndBody,fetchHistory,fetchReplacement,handleClick,ignoreClick,initializeTurbolinks,installClickHandlerLast,installDocumentReadyPageEventTriggers,installHistoryChangeHandler,installJqueryAjaxSuccessPageUpdateTrigger,loadedAssets,noTurbolink,nonHtmlLink,nonStandardClick,notKokenLink,pageCache,pageChangePrevented,pagesCached,popCookie,processResponse,recallScrollPosition,referer,reflectNewUrl,reflectRedirectedUrl,rememberCurrentState,rememberCurrentUrl,rememberReferer,removeHash,removeHashForIE10compatiblity,removeNoscriptTags,requestMethodIsSafe,resetScrollPosition,targetLink,triggerEvent,visit,xhr,_ref,__hasProp={}.hasOwnProperty,__indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};pageCache={},cacheSize=10,currentState=null,loadedAssets=null,referer=null,createDocument=null,xhr=null,fetchReplacement=function(e){return rememberReferer(),cacheCurrentPage(),triggerEvent("page:fetch",{url:e}),xhr!=null&&xhr.abort(),xhr=new XMLHttpRequest,xhr.open("GET",removeHashForIE10compatiblity(e),!0),xhr.setRequestHeader("Accept","text/html, application/xhtml+xml, application/xml"),xhr.setRequestHeader("X-XHR-Referer",referer),xhr.onload=function(){var t;return triggerEvent("page:receive"),(t=processResponse())?(reflectNewUrl(e),changePage.apply(null,extractTitleAndBody(t)),reflectRedirectedUrl(),resetScrollPosition(),triggerEvent("page:load")):document.location.href=e},xhr.onloadend=function(){return xhr=null},xhr.onabort=function(){return rememberCurrentUrl()},xhr.onerror=function(){return document.location.href=e},xhr.send()},fetchHistory=function(e){return cacheCurrentPage(),xhr!=null&&xhr.abort(),changePage(e.title,e.body),recallScrollPosition(e),triggerEvent("page:restore")},cacheCurrentPage=function(){return pageCache[currentState.position]={url:document.location.href,body:document.body,title:document.title,positionY:window.pageYOffset,positionX:window.pageXOffset},constrainPageCacheTo(cacheSize)},pagesCached=function(e){e==null&&(e=cacheSize);if(/^[\d]+$/.test(e))return cacheSize=parseInt(e)},constrainPageCacheTo=function(e){var t,n;for(t in pageCache){if(!__hasProp.call(pageCache,t))continue;n=pageCache[t],t<=currentState.position-e&&(pageCache[t]=null)}},changePage=function(e,t,n,r){return document.title=e,document.documentElement.replaceChild(t,document.body),n!=null&&CSRFToken.update(n),removeNoscriptTags(),r&&executeScriptTags(),currentState=window.history.state,triggerEvent("page:change"),triggerEvent("page:update")},executeScriptTags=function(){var e,t,n,r,i,s,o,u,a,f,l,c;s=Array.prototype.slice.call(document.body.querySelectorAll('script:not([data-turbolinks-eval="false"])'));for(o=0,a=s.length;o<a;o++){i=s[o];if((l=i.type)!==""&&l!=="text/javascript")continue;t=document.createElement("script"),c=i.attributes;for(u=0,f=c.length;u<f;u++)e=c[u],t.setAttribute(e.name,e.value);t.appendChild(document.createTextNode(i.innerHTML)),r=i.parentNode,n=i.nextSibling,r.removeChild(i),r.insertBefore(t,n)}},removeNoscriptTags=function(){var e,t,n,r;t=Array.prototype.slice.call(document.body.getElementsByTagName("noscript"));for(n=0,r=t.length;n<r;n++)e=t[n],e.parentNode.removeChild(e)},reflectNewUrl=function(e){if(e!==referer)return window.history.pushState({turbolinks:!0,position:currentState.position+1},"",e)},reflectRedirectedUrl=function(){var e,t;if(e=xhr.getResponseHeader("X-XHR-Redirected-To"))return t=removeHash(e)===e?document.location.hash:"",window.history.replaceState(currentState,"",e+t)},rememberReferer=function(){return referer=document.location.href},rememberCurrentUrl=function(){return window.history.replaceState({turbolinks:!0,position:Date.now()},"",document.location.href)},rememberCurrentState=function(){return currentState=window.history.state},recallScrollPosition=function(e){return window.scrollTo(e.positionX,e.positionY)},resetScrollPosition=function(){return document.location.hash?document.location.href=document.location.href:window.scrollTo(0,0)},removeHashForIE10compatiblity=function(e){return removeHash(e)},removeHash=function(e){var t;return t=e,e.href==null&&(t=document.createElement("A"),t.href=e),t.href.replace(t.hash,"")},popCookie=function(e){var t,n;return t=((n=document.cookie.match(new RegExp(e+"=(\\w+)")))!=null?n[1].toUpperCase():void 0)||"",document.cookie=e+"=; expires=Thu, 01-Jan-70 00:00:01 GMT; path=/",t},triggerEvent=function(e,t){var n;return n=document.createEvent("Events"),t&&(n.data=t),n.initEvent(e,!0,!0),document.dispatchEvent(n)},pageChangePrevented=function(){return!triggerEvent("page:before-change")},processResponse=function(){var e,t,n,r,i,s;t=function(){var e;return 400<=(e=xhr.status)&&e<600},s=function(){return xhr.getResponseHeader("Content-Type").match(/^(?:text\/html|application\/xhtml\+xml|application\/xml)(?:;|$)/)},r=function(e){var t,n,r,i,s;i=e.head.childNodes,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],(typeof t.getAttribute==="function"?t.getAttribute("data-turbolinks-track"):void 0)!=null&&s.push(t.src||t.href);return s},e=function(e){var t;return loadedAssets||(loadedAssets=r(document)),t=r(e),t.length!==loadedAssets.length||i(t,loadedAssets).length!==loadedAssets.length},i=function(e,t){var n,r,i,s,o;e.length>t.length&&(s=[t,e],e=s[0],t=s[1]),o=[];for(r=0,i=e.length;r<i;r++)n=e[r],__indexOf.call(t,n)>=0&&o.push(n);return o};if(!t()&&s()){n=createDocument(xhr.responseText);if(n&&!e(n))return n}},extractTitleAndBody=function(e){var t;return t=e.querySelector("title"),[t!=null?t.textContent:void 0,e.body,CSRFToken.get(e).token,"runScripts"]},CSRFToken={get:function(e){var t;return e==null&&(e=document),{node:t=e.querySelector('meta[name="csrf-token"]'),token:t!=null?typeof t.getAttribute=="function"?t.getAttribute("content"):void 0:void 0}},update:function(e){var t;t=this.get();if(t.token!=null&&e!=null&&t.token!==e)return t.node.setAttribute("content",e)}},browserCompatibleDocumentParser=function(){var e,t,n,r,i,s;t=function(e){return(new DOMParser).parseFromString(e,"text/html")},e=function(e){var t;return t=document.implementation.createHTMLDocument(""),t.documentElement.innerHTML=e,t},n=function(e){var t;return t=document.implementation.createHTMLDocument(""),t.open("replace"),t.write(e),t.close(),t};try{if(window.DOMParser)return i=t("<html><body><p>test"),t}catch(o){return r=o,i=e("<html><body><p>test"),e}finally{if((i!=null?(s=i.body)!=null?s.childNodes.length:void 0:void 0)!==1)return n}},installClickHandlerLast=function(e){if(!e.defaultPrevented)return document.removeEventListener("click",handleClick,!1),document.addEventListener("click",handleClick,!1)},handleClick=function(e){var t;if(!e.defaultPrevented){t=extractLink(e);if(t.nodeName==="A"&&!ignoreClick(e,t))return pageChangePrevented()||visit(t.href),e.preventDefault()}},extractLink=function(e){var t;t=e.target;while(!!t.parentNode&&t.nodeName!=="A")t=t.parentNode;return t},crossOriginLink=function(e){return location.protocol!==e.protocol||location.host!==e.host},anchoredLink=function(e){return(e.hash&&removeHash(e))===removeHash(location)||e.href===location.href+"#"},nonHtmlLink=function(e){var t;return t=removeHash(e),t.match(/\.[a-z]+(\?.*)?$/g)&&!t.match(/\.(html|php)?(\?.*)?$/g)},noTurbolink=function(e){var t;while(!t&&e!==document)t=e.getAttribute("data-no-turbolink")!=null,e=e.parentNode;return t},targetLink=function(e){return e.target.length!==0},nonStandardClick=function(e){return e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey},notKokenLink=function(e){return e.getAttribute("data-koken-internal")==null},ignoreClick=function(e,t){return notKokenLink(t)||crossOriginLink(t)||anchoredLink(t)||nonHtmlLink(t)||noTurbolink(t)||targetLink(t)||nonStandardClick(e)},installDocumentReadyPageEventTriggers=function(){return document.addEventListener("DOMContentLoaded",function(){return triggerEvent("page:change"),triggerEvent("page:update")},!0)},installJqueryAjaxSuccessPageUpdateTrigger=function(){if(typeof jQuery!="undefined")return $(document).on("ajaxSuccess",function(e,t,n){if(!$.trim(t.responseText))return;return triggerEvent("page:update")})},installHistoryChangeHandler=function(e){var t,n;if((n=e.state)!=null?n.turbolinks:void 0)return(t=pageCache[e.state.position])?fetchHistory(t):visit(e.target.location.href)},initializeTurbolinks=function(){return rememberCurrentUrl(),rememberCurrentState(),createDocument=browserCompatibleDocumentParser(),document.addEventListener("click",installClickHandlerLast,!0),window.addEventListener("popstate",installHistoryChangeHandler,!1)},browserSupportsPushState=window.history&&window.history.pushState&&window.history.replaceState&&window.history.state!==void 0,browserIsntBuggy=!navigator.userAgent.match(/CriOS\//),requestMethodIsSafe=(_ref=popCookie("request_method"))==="GET"||_ref==="",browserSupportsTurbolinks=browserSupportsPushState&&browserIsntBuggy&&requestMethodIsSafe,installDocumentReadyPageEventTriggers(),installJqueryAjaxSuccessPageUpdateTrigger(),browserSupportsTurbolinks?(visit=fetchReplacement,initializeTurbolinks()):visit=function(e){return document.location.href=e},this.Turbolinks={visit:visit,pagesCached:pagesCached,supported:browserSupportsTurbolinks};